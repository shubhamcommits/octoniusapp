<app-portfolio-header [portfolioData]="portfolioData" [userData]="userData"></app-portfolio-header>

<mat-tab-group>
    <mat-tab [label]="groupsLabel">
        <app-portfolio-groups-list *ngIf="portfolioData" [userData]="userData" [portfolioData]="portfolioData" [workspaceData]="workspaceData" [userGroups]="userGroups"></app-portfolio-groups-list>

        <div class="row" style="padding: 0 20px;justify-content: space-between;">
            <div class="col-md-9" style="padding: 20px 0;">
                <h2 i18n="@@portfolioDetails.performanceDashboard" style="float: left; margin-right: 10px;">Performance dashboard</h2>
                <span class="material-icons-outlined" style="cursor: pointer;">info</span>
            </div>

            <div>
                <mat-form-field>
                    <mat-select ngDefaultControl (selectionChange)="periodSelected($event)" (click)="$event.stopPropagation()"
                        [(value)]="period" name="period">
                        <mat-option *ngFor="let p of periods" [value]="p.key">{{ p.value }}</mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
        </div>

        <div class="row" style="padding: 0 20px;">
            <div class="col-md-3 box">
                <app-portfolio-work-statistics-card [period]="period" [portfolioId]="portfolioData?._id" [type]="'bar'"></app-portfolio-work-statistics-card>
            </div>
        
            <div class="col-md-3 box">
                <app-portfolio-work-statistics-card [period]="period" [portfolioId]="portfolioData?._id" [type]="'doughnut'"></app-portfolio-work-statistics-card>
            </div>
        </div>

        <div class="row" style="padding: 20px;">
            <div class="col-md-12 box">
                <app-portfolio-projects-performance-card [portfolioId]="portfolioData?._id"></app-portfolio-projects-performance-card>
            </div>
        </div>
    </mat-tab>

    <mat-tab [label]="workloadLabel">
        <app-portfolio-members-workload-card *ngIf="portfolioData" [portfolioData]="portfolioData" [userData]="userData"></app-portfolio-members-workload-card>
    </mat-tab>
</mat-tab-group>

<!-- LOADING SPINNER STARTS -->
<ng-container *ngIf="isLoading$ | async">
    <app-loading-spinner></app-loading-spinner>
</ng-container>
<!-- LOADING SPINNER ENDS -->