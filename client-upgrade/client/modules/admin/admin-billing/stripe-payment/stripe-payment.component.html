<!-- *ngIf="!workspaceData?.billing?.current_period_end"  -->

<!--here we add created property to use change detection.-->

<!-- *ngIf="workspaceData?.billing?.current_period_end" -->


<app-start-subscription *ngIf="!workspaceData?.billing?.current_period_end; else subscriptionTemp" [userData]="userData"
  [workspaceData]="workspaceData" [publicFunctions]="publicFunctions" [subscription]="subscription">
</app-start-subscription>

<ng-container *ngIf="isLoading$ | async">
  <app-loading-spinner></app-loading-spinner>
</ng-container>

<ng-template #subscriptionTemp>
<app-subscription-details *ngIf="workspaceData && subscription" 
  [workspaceData]="workspaceData" 
  [publicFunctions]="publicFunctions"
  [subscription]="subscription">
</app-subscription-details>
</ng-template>

<!-- *ngIf="subscription"  -->


<div *ngIf="failedPayments.length > 0" class="card-tile">
  <h3 class="f-payments-title">Failed payments:</h3>
  <ul class="list-group">
    <li *ngFor="let f_payment of failedPayments; let index = index ; trackBy: utilityService.trackByIndex"
      class="list-group-item disabled">
      <span>{{f_payment.data.object.period_start | amFromUnix | amDateFormat:'MMMM Do YYYY'}} -
        {{f_payment.data.object.period_end | amFromUnix | amDateFormat:'MMMM Do YYYY'}}</span>
      <span>{{f_payment.data.object.amount_due | currency:'EUR'}}</span>
      <button (click)="renewSubscription()" class="btn btn-outline-danger">Renew subcription</button>
    </li>
  </ul>
</div>

<div *ngIf="workspaceData.billing.success_payments.length > 0" class="card-tile">
  <h3 class="s-payments-title">Completed payments:</h3>
  <ul class="list-group">
    <li *ngFor="let s_payment of workspaceData.billing.success_payments" class="list-group-item disabled">
      <span>{{s_payment.data.object.period_start | amFromUnix | amDateFormat:'MMMM Do YYYY'}} -
        {{s_payment.data.object.period_end | amFromUnix | amDateFormat:'MMMM Do YYYY'}}</span>
      <span>{{s_payment.data.object.amount_due | currency:'EUR'}}</span>
    </li>
  </ul>
</div>