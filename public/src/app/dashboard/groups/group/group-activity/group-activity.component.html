<div class="row main-actvity" id="top-card">
  <div class="col-md-4">
    <div class="row sidecontent">
      <div class="card sideinnercard">
        <div *ngIf="!isItMyWorkplace; else descrPersWorkplace" class="card-block">

          <h6 class="card-title">Group Info </h6>
          <hr />
          <p class="card-text">{{groupDataService.group?._admins?.length + groupDataService.group?._members?.length}}
            Members</p>
          <p class="card-text">{{groupDataService.group?.description}}</p>

        </div>
        <ng-template #descrPersWorkplace>
          <div class="card-block">

            <h6 class="card-title">Personal workplace</h6>
            <hr />
            <p class="card-text">This is your personal space. Everything you create here is private.</p>
          </div>
        </ng-template>
      </div>

      <div class="card sideinnercard">
        <div *ngIf="!isItMyWorkplace; else personalmetrics" class="card-block">

          <h6 class="card-title"><b>Hi {{user?.first_name}},</b></h6>
          <hr />

          <div class="row">
            <div class="col-md-12">
                <p>
                    Your team has <span class="todo bold">{{pendingToDoTaskCount + pendingInProgressTaskCount + completedTaskCount}}</span> assignment(s) this week.
                </p>
            </div>

            </div>
         
         <div class="row">
           <div class="col-md-6"><h4 class="todo" style="margin-top:30px"><b>{{pendingToDoTaskCount}} To do</b></h4></div>
           <div class="col-md-4">                 

            <b><circle-progress 
              [percent]="todoPercent">
            </circle-progress></b>
           </div>
         </div>

         <div class="row">
            <div class="col-md-6"><h4 class="working" style="margin-top:30px"><b>{{pendingInProgressTaskCount}} In progress</b></h4></div>
            <div class="col-md-4">                 
              <b><circle-progress 
                [percent]="inprogressPercent">
              </circle-progress></b>
            </div>
          </div>

          <div class="row">
              <div class="col-md-6"><h4 class="done" style="margin-top:30px"><b>{{completedTaskCount}} Done</b></h4></div>
              <div class="col-md-4">                 
                <b><circle-progress 
                  [percent]="completedPercent">
                </circle-progress></b>
              </div>
            </div>

        </div>
        <ng-template #personalmetrics>

            <h6 class="card-title"><b>Hi {{user?.first_name}},</b></h6>
            <hr />
  
            <div class="row">
              <div class="col-md-12">
                  <p>
                      You have <span class="todo bold">{{pendingToDoTaskCount + pendingInProgressTaskCount + completedTaskCount}}</span> assignments this week.
                  </p>
              </div>
  
              </div>
           
           <div class="row">
             <div class="col-md-6"><h4 class="todo" style="margin-top:30px"><b>{{pendingToDoTaskCount}} To do</b></h4></div>
             <div class="col-md-4">                 
  
              <b><circle-progress 
                [percent]="todoPercent">
              </circle-progress></b>
             </div>
           </div>
  
           <div class="row">
              <div class="col-md-6"><h4 class="working" style="margin-top:30px"><b>{{pendingInProgressTaskCount}} In progress</b></h4></div>
              <div class="col-md-4">                 
                <b><circle-progress 
                  [percent]="inprogressPercent">
                </circle-progress></b>
              </div>
            </div>
  
            <div class="row">
                <div class="col-md-6"><h4 class="done" style="margin-top:30px"><b>{{completedTaskCount}} Done</b></h4></div>
                <div class="col-md-4">                 
                  <b><circle-progress 
                    [percent]="completedPercent">
                  </circle-progress></b>
                </div>
              </div>
  
       
        </ng-template>
      </div>
    </div>
  </div>

  <div class="col-md-8">
    <!-- news badge-->
    <div class="feed-new-update-pill" style="display:block" *ngIf="this.show_new_posts_badge == 1; else newsbadge">
      <div class="inner-news">
        <button type="button" class="btn btn-primary news-badge" (click)="this.loadGroupPosts();  this.scrollToTop('#top-card');">
          <i class="material-icons">arrow_upward</i> New posts <span class="badge badge-light"></span>
        </button>
      </div>

    </div>
    <ng-template #newsbadge></ng-template>
    <!-- news badge-->


    <postbox
      *ngIf="modules"
      [modules]="modules"
      [modulesLoaded]="modulesLoaded"
      [isItMyWorkplace]="isItMyWorkplace"
      [user]="user"
      [group]="group"
      [socket]="socket"
      [allMembersId]="allMembersId"
      [user_data]="user_data"
      (newPost)="addNewPostToPosts($event); statusChanged()">
    </postbox>


    <div class="search-results" infiniteScroll [infiniteScrollDistance]="0" [immediateCheck]="true" (scrolled)="onScroll()">
      <div *ngIf="posts.length == 0">
        <img src='../../../assets/images/overview-emptystate.svg' style=" margin: 0 auto; display:block; width: 600px">
      </div>
      <div *ngFor="let post of posts; let i = index;">
        <ul class="list-group ">

          <!-- Normal post -->
          <normal-group-post
            *ngIf="post.type === 'normal'"
            [post]="post"
            [user]="user"
            [modules]="modules"
            [user_data]="user_data"
            [allMembersId]="allMembersId"
            [group]="group"
            [socket]="socket"
            (deletePost)="onDeletePost($event)"
            ng-repeat="post in posts">
          </normal-group-post>

          <!-- task post -->
          <task-group-post
            *ngIf="post.type === 'task'"
            [post]="post"
            [user]="user"
            [isItMyWorkplace]="isItMyWorkplace"
            [modules]="modules"
            [user_data]="user_data"
            [allMembersId]="allMembersId"
            [group]="group"
            [socket]="socket"
            (statusChanged)="statusChanged()"
            (deletePost)="onDeletePost($event)"
            ng-repeat="post in posts">
          </task-group-post>


          <!--EVENT post-->
          <event-group-post
            *ngIf="post.type === 'event'"
            [post]="post"
            [user]="user"
            [isItMyWorkplace]="isItMyWorkplace"
            [modules]="modules"
            [user_data]="user_data"
            [allMembersId]="allMembersId"
            [group]="group"
            [socket]="socket"
            (deletePost)="onDeletePost($event)"
            ng-repeat="post in posts">
          </event-group-post>
        </ul>

      </div>

    </div>
    <div *ngIf="isLoading$ | async">
      <div class="load-8">
        <h6><b>Loading Data...</b></h6>
        <div class="line"></div>
      </div>
    </div>
  </div>
</div>
